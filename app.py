from flask import Flask, jsonify
from flask_limiter import Limiter
from flask_limiter.util import get_remote_address
import database

app = Flask(__name__)

# Set up rate limiting
limiter = Limiter(
    get_remote_address,
    app=app,
    default_limits=["200 per day", "50 per hour"]
)

@app.route('/v1/urlinfo/<path:resource_url>', methods=['GET'])
@limiter.limit("10 per minute")  # Limit to 10 requests per minute per client
def url_info(resource_url):
    is_malicious = database.check_url(resource_url)
    response = {
        'url': resource_url,
        'is_malicious': is_malicious
    }
    return jsonify(response)

if __name__ == '__main__':
    app.run(debug=True)

